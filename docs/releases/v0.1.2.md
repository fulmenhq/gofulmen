# Release Notes - gofulmen v0.1.2

**Release Date**: October 20, 2025
**Release Type**: Major Feature Release - Progressive Logging + Enhanced Config/Schema + Pathfinder Security
**Status**: ✅ Ready for Release

## Overview

Version 0.1.2 adds the **Progressive Logging System** with profiles, middleware pipeline, and policy enforcement, **enhanced schema system** with catalog metadata and composition helpers, **three-layer configuration loader**, and **pathfinder security fixes** with path traversal protection. This release includes 200+ tests with 89.2% coverage and full cross-language compatibility validation.

## Features

### Progressive Logging System (Complete)

Enterprise-grade logging with graduated complexity via four progressive profiles:

#### Progressive Profiles

- **SIMPLE**: Minimal console logging for CLI tools (no middleware, human-readable)
- **STRUCTURED**: JSON logging for API services (optional middleware, file sinks)
- **ENTERPRISE**: Full observability for production (required middleware, throttling, policy)
- **CUSTOM**: Flexible configuration for specialized use cases

#### Middleware Pipeline

Pluggable event processing with ordered execution:

- **Correlation Middleware**: UUIDv7 injection for distributed tracing (time-sortable, monotonic)
- **Redaction Middleware**: Pattern-based PII/secrets removal (configurable patterns)
- **Throttling Middleware**: Token bucket rate limiting (1000-5000 logs/sec, drop policies)
- **Middleware Registry**: Global factory pattern with name-based lookup
- **Custom Middleware**: Plugin interface for application-specific processing

#### Policy Enforcement

YAML-based logging governance:

```yaml
allowedProfiles: [SIMPLE, STRUCTURED, ENTERPRISE]
requiredProfiles:
  workhorse: [ENTERPRISE]
  service: [STRUCTURED, ENTERPRISE]
  cli: [SIMPLE, STRUCTURED]
environmentRules:
  production: [STRUCTURED, ENTERPRISE]
  development: [SIMPLE, STRUCTURED, ENTERPRISE]
```

Policy resolution order:

1. `.goneat/logging-policy.yaml` (repository-local)
2. `/etc/fulmen/logging-policy.yaml` (system-wide)
3. `/org/logging-policy.yaml` (organization-managed)

#### Configuration & Validation

- **Profile Normalization**: Case-insensitive (`simple` → `SIMPLE`), default (`""` → `SIMPLE`)
- **Middleware Normalization**: Deduplication by name (last wins), nil config initialization
- **Throttling Defaults**: maxRate=1000, burstSize=2x maxRate, dropPolicy=drop-oldest
- **Invalid Profile Warnings**: Clear validation errors before schema validation
- **Enabled Middleware Counting**: ENTERPRISE checks only enabled middleware

#### Full Crucible Envelope

20+ fields for comprehensive observability:

- **Core**: timestamp, level, message, service, environment
- **Distributed Tracing**: correlationId, traceId, spanId, contextId, requestId
- **Context**: userId, sessionId, component, module, function
- **Error Tracking**: error, errorType, stackTrace
- **Performance**: duration, status
- **Metadata**: tags, fields (extensible key-value pairs)

#### Testing & Documentation

- **Integration Tests**: 10 end-to-end tests for all profiles and middleware combinations
- **Golden Tests**: 12 cross-language compatibility tests (UUIDv7, RFC3339Nano, severity mapping)
- **Godoc Examples**: 10+ comprehensive examples (profiles, middleware, policy enforcement)
- **Progressive Logging Guide**: Complete documentation with migration paths
- **Test Coverage**: 89.2% (190+ tests, all passing)

#### Cross-Language Compatibility

- **Field Naming**: camelCase JSON (correlationId, requestId, traceId, spanId)
- **Timestamp Format**: RFC3339Nano for nanosecond precision
- **Severity Levels**: Uppercase (TRACE, DEBUG, INFO, WARN, ERROR, FATAL)
- **UUIDv7 Format**: Time-sortable correlation IDs with monotonic ordering

**Test Coverage**: 89.2% (190+ passing tests)

### Enhanced Schema System

Comprehensive schema validation with catalog support:

#### Catalog Metadata

- Schema versioning and discovery
- Namespace organization (crucible-go, pathfinder, logging)
- Offline metaschema validation (draft 2020-12)

#### Shared Validator Cache

- Performance optimization via cached validators
- Type-safe schema ID lookups
- Automatic metaschema validation

#### Composition & Diff Helpers

- `MergeJSONSchemas()`: Combine base + overlay schemas
- `DiffJSONSchemas()`: Compare schema versions
- Runtime schema composition

#### Structured Diagnostics

- Detailed error reporting with JSON pointers
- Schema path tracking for validation errors
- Integration with logging system

#### CLI Shim

`gofulmen-schema` command with optional goneat bridge:

```bash
# Standalone validation
go run ./cmd/gofulmen-schema -- schema validate \
  --schema-id pathfinder/v1.0.0/path-result ./path-result.json

# Metaschema validation
go run ./cmd/gofulmen-schema -- schema validate-schema ./schema.json

# Optional goneat integration
go run ./cmd/gofulmen-schema -- schema validate \
  --use-goneat --schema-id pathfinder/v1.0.0/path-result ./path-result.json
```

### Enhanced Config System

Three-layer configuration with validation:

#### Three-Layer Loading

- **Defaults**: Embedded defaults from config files
- **User**: User-specific configuration (~/.config/fulmen/)
- **Runtime**: Runtime overrides (environment variables, CLI args)

#### Schema Validation Helpers

```go
opts := config.LayeredConfigOptions{
    Category:     "sample",
    Version:      "v1.0.0",
    DefaultsFile: "sample-defaults.yaml",
    SchemaID:     "sample/v1.0.0/schema",
}

merged, diagnostics, err := config.LoadLayeredConfig(opts,
    map[string]any{"settings": map[string]any{"retries": 5}},
)
```

#### Environment Override Parsing

Type-safe environment variable handling:

```go
envOverrides, err := config.LoadEnvOverrides([]config.EnvVarSpec{
    {Name: "APP_RETRIES", Path: []string{"settings", "retries"}, Type: config.EnvInt},
    {Name: "APP_TIMEOUT", Path: []string{"settings", "timeout"}, Type: config.EnvDuration},
})
```

### Pathfinder Security & Compliance

Security fixes and spec compliance:

#### Security Fixes

- **Path Traversal Protection**: `ValidatePathWithinRoot()` prevents glob escapes (`../**/*.go`)
- **Hidden File Filtering**: All path segments checked (prevents `.secrets/key.pem` leakage)

#### Spec Compliance

- **Metadata Population**: `PathResult.Metadata` includes size and mtime (RFC3339Nano)
- **.fulmenignore Support**: Gitignore-style pattern matching with directory semantics
- **Unused Config Fields**: Documented as future enhancements (MaxWorkers, CacheEnabled, Constraint)

#### Testing

- Comprehensive path traversal prevention tests
- Multi-level hidden directory validation
- Metadata accuracy verification
- .fulmenignore pattern matching tests

## Breaking Changes

None - fully backward compatible with v0.1.1.

## Migration Notes

### From v0.1.1 to v0.1.2

Existing code continues to work unchanged. To adopt progressive logging:

#### Minimal Migration (Add Profile)

```go
// Before (v0.1.1)
config := &logging.LoggerConfig{
    Service:     "my-service",
    Environment: "production",
}

// After (v0.1.2) - add profile
config := &logging.LoggerConfig{
    Profile:     logging.ProfileStructured,  // NEW
    Service:     "my-service",
    Environment: "production",
}
```

#### Enable Middleware

```go
config.Middleware = []logging.MiddlewareConfig{
    {Name: "correlation", Enabled: true, Order: 100},
    {Name: "redaction", Enabled: true, Order: 200},
    {Name: "throttling", Enabled: true, Order: 300},
}
```

#### Enterprise Profile with Policy

```go
logger := logging.New("datawhirl",
    logging.WithProfile(logging.ProfileEnterprise),
    logging.WithPolicyFile("/org/logging-policy.yaml"),
)
```

See `logging/README.md` for complete migration guide and progressive profile documentation.

## Dependencies

All dependencies remain stable from v0.1.1:

- **Go**: 1.21+
- **Crucible**: 2025.10.2
- External packages:
  - `github.com/google/uuid` (for UUIDv7 generation)
  - `github.com/santhosh-tekuri/jsonschema/v6` (for schema validation)
  - `go.uber.org/zap` (for structured logging)
  - `gopkg.in/yaml.v3` (for YAML support)

## Quality Gates

- [x] All 200+ tests passing
- [x] Coverage at 89.2% (logging package)
- [x] `make check-all` passed (sync, build, fmt, lint, test)
- [x] Code formatted with goneat
- [x] No linting issues
- [x] Progressive logging compliant with Crucible standards
- [x] Pathfinder security fixes verified
- [x] Cross-language compatibility validated
- [x] Documentation complete
- [x] Proper agentic attribution

## Release Checklist

- [x] Version number set in VERSION (0.1.2)
- [x] CHANGELOG.md updated with v0.1.2 release notes
- [x] RELEASE_NOTES.md updated
- [x] docs/releases/v0.1.2.md created
- [x] README.md reviewed and updated
- [x] gofulmen_overview.md reviewed and updated
- [x] All tests passing
- [x] Code quality checks passing
- [x] Security fixes verified
- [x] Documentation reviewed
- [x] Progressive logging guide complete
- [x] Schema CLI shim documented
- [x] Config three-layer system documented
- [ ] Git tag created (v0.1.2) - pending
- [ ] Tag pushed to GitHub - pending

## Contributors

- **Foundation Forge** (@foundation-forge) - Progressive logging, enhanced config/schema, pathfinder security, documentation
- **@3leapsdave** - Supervision, architecture guidance, release management

## Related Documentation

- [Progressive Logging Guide](../logging/README.md)
- [Schema Package Documentation](../schema/README.md)
- [Config Package Documentation](../config/README.md)
- [Pathfinder Package Documentation](../pathfinder/README.md)
- [Gofulmen Overview](../gofulmen_overview.md)
- [Repository Operations SOP](../crucible-go/sop/repository-operations-sop.md)
- [Agentic Attribution Standard](../crucible-go/standards/agentic-attribution.md)
- [Fulmen Helper Library Standard](../crucible-go/architecture/fulmen-helper-library-standard.md)
- [CHANGELOG](../../CHANGELOG.md)

## Next Steps

### v0.1.3+ (Planned)

- File checksums with xxHash128 (pathfinder enhancement)
- Additional coverage improvements for bootstrap package
- Performance optimizations
- Additional middleware (sampling, batching)

### v0.2.0+ (Future)

- Cloud storage evaluation (pending cross-library discussion)
- Metrics integration (following logging pattern)
- Tracing integration (OpenTelemetry support)
- Additional Crucible catalog integrations

---

**Generated by**: Foundation Forge
**Supervised by**: @3leapsdave
**Release Manager**: @3leapsdave
