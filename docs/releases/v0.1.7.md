# Release Notes: v0.1.7

**Release Date**: October 29, 2025  
**Release Type**: CI/CD Infrastructure + Bug Fixes  
**Status**: ✅ Ready for Release

## Overview

Adds GitHub Actions CI workflow for automated testing and quality checks, preparing the repository for public release. Includes critical bug fixes for Prometheus metric naming and RFC3339Nano timestamp tests to ensure CI passes on all Go versions.

## Features

### GitHub Actions CI Workflow

**Automated Testing:**

- Tests on Go 1.21, 1.22, 1.23 (multi-version matrix)
- Runs on ubuntu-latest
- Executes on every push to main and all PRs

**Quality Gates:**

- Download and verify dependencies
- Bootstrap goneat v0.3.2 from GitHub releases
- Run `make test` - All test suites
- Run `make lint` - go vet + goneat assess
- Build all packages

**External Installation Test:**

- Verifies `go get github.com/fulmenhq/gofulmen@main` works
- Currently disabled (`if: false`) until repository is public
- Enable after going public by removing `if: false` line

### All Dependencies Public

- ✅ GitHub Actions: `actions/checkout@v4`, `actions/setup-go@v5`
- ✅ Go modules: Crucible v0.2.1 and standard packages (all public)
- ✅ goneat v0.3.2: Downloaded from public GitHub releases
- ✅ No secrets or private repos required

## Workflow File

Location: `.github/workflows/ci.yml`

Runs on: `push` to main, `pull_request` to main

## Testing Locally

Same commands CI runs:

```bash
make bootstrap
make test
make lint
go build ./...
```

## Bug Fixes

### Prometheus Metric Naming (telemetry/exporters)

**Commit**: `c42225c` - "fix: remove automatic Prometheus metric suffix duplication"

**Problem:**
- `writeCounterMetrics()` and `writeGaugeMetrics()` were automatically appending `_total` and `_gauge` suffixes
- Callers already provided metrics with these suffixes (e.g., `http_requests_total`)
- Result: Double suffixes like `http_requests_total_total` and `memory_bytes_gauge_gauge`

**Solution:**
- Removed automatic suffix addition in prometheus.go
- Updated test expectations in prometheus_routing_test.go
- Metric names now follow Prometheus conventions (caller-provided suffixes)

**Impact:**
- Fixed CI test failures: `TestPrometheusMetricTypeRouting`, `TestPrometheusMetricTypeRoutingInHandler`
- All tests pass on Go 1.21, 1.22, 1.23

### RFC3339Nano Timestamp Test (logging)

**Commit**: `f0f583b` - "fix: RFC3339Nano timestamp test for Go 1.21 compatibility"

**Problem:**
- `TestGolden_RFC3339NanoTimestampCompatibility` failed on Go 1.21
- RFC3339Nano format omits trailing zeros in nanoseconds
- Timestamps with few nanoseconds (e.g., 25 chars) failed the 30-char minimum check
- Example: `2009-02-13T18:31:30-05:00` vs `2025-10-29T14:23:33.327779-04:00`

**Solution:**
- Use fixed timestamp with non-zero nanoseconds (`time.Unix(1234567890, 123456789)`)
- Adjusted minimum length from 30 to 29 chars (realistic for timestamps with nanos)
- Added explicit nanosecond preservation check

**Impact:**
- Consistent test behavior across Go 1.21, 1.22, 1.23
- CI now passes on all supported Go versions

## Post-Public Release

After making repository public:

1. Edit `.github/workflows/ci.yml`
2. Remove `if: false` from `install-test` job
3. Commit and push
4. Monitor GitHub Actions tab for all jobs passing

## Version Information

- **Gofulmen**: 0.1.7
- **Crucible**: v0.2.1
- **Go Versions Tested**: 1.21, 1.22, 1.23
- **goneat**: v0.3.2

## Summary

Version 0.1.7 adds essential CI infrastructure with multi-version testing and automated quality gates. All dependencies are public and accessible.

**Ready for CI testing.** ✅
